#!/bin/bash

# Color codes
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
NC='\033[0m' # No Color

clear

echo -e "${CYAN}"
cat << "EOF"
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                               â•‘
â•‘        Artists & Albums API - Senior Backend Project         â•‘
â•‘                                                               â•‘
â•‘                    Java | Spring Boot | REST                 â•‘
â•‘                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EOF
echo -e "${NC}"

echo ""
echo -e "${YELLOW}â•â•â• PROJECT INFORMATION â•â•â•${NC}"
echo "Framework: Spring Boot 3.3"
echo "Language: Java 17"
echo "Database: PostgreSQL 16"
echo "Storage: MinIO (S3-compatible)"
echo "Containerization: Docker & Docker Compose"

echo ""
echo -e "${YELLOW}â•â•â• REQUIREMENTS STATUS â•â•â•${NC}"
echo -e "${GREEN}âœ“${NC} Requisitos Gerais (12/12)"
echo -e "${GREEN}âœ“${NC} Requisitos SÃªnior (5/5)"
echo -e "${GREEN}âœ“${NC} Total: 17/17 âœ“âœ“âœ“"

echo ""
echo -e "${YELLOW}â•â•â• KEY FEATURES â•â•â•${NC}"
echo -e "${GREEN}âœ“${NC} JWT Authentication (5 min expiration + refresh)"
echo -e "${GREEN}âœ“${NC} Rate Limiting (10 req/min per user)"
echo -e "${GREEN}âœ“${NC} WebSocket Notifications (Real-time albums)"
echo -e "${GREEN}âœ“${NC} MinIO Integration (Presigned URLs, 30 min expiry)"
echo -e "${GREEN}âœ“${NC} CORS Security (Domain blocking)"
echo -e "${GREEN}âœ“${NC} Pagination (All endpoints)"
echo -e "${GREEN}âœ“${NC} Health Checks (Liveness + Readiness)"
echo -e "${GREEN}âœ“${NC} Regional Sync (External API integration)"
echo -e "${GREEN}âœ“${NC} OpenAPI/Swagger (Interactive docs)"
echo -e "${GREEN}âœ“${NC} Unit Tests (JUnit 5 + Mockito)"

echo ""
echo -e "${YELLOW}â•â•â• QUICK START â•â•â•${NC}"
echo ""
echo -e "  ${CYAN}Option 1: Docker Compose (Recommended)${NC}"
echo "    $ docker-compose up -d"
echo "    â†’ API: http://localhost:8080/api"
echo "    â†’ Swagger: http://localhost:8080/api/swagger-ui.html"
echo "    â†’ MinIO: http://localhost:9001"
echo ""
echo -e "  ${CYAN}Option 2: Local with Maven${NC}"
echo "    $ mvn clean package"
echo "    $ java -jar target/artists-api-1.0.0.jar"
echo ""
echo -e "  ${CYAN}Option 3: Using Make${NC}"
echo "    $ make docker-up"
echo "    $ make logs"

echo ""
echo -e "${YELLOW}â•â•â• CREDENTIALS â•â•â•${NC}"
echo "API:"
echo "  username: admin"
echo "  password: admin"
echo ""
echo "MinIO:"
echo "  username: minioadmin"
echo "  password: minioadmin"

echo ""
echo -e "${YELLOW}â•â•â• PROJECT STRUCTURE â•â•â•${NC}"
cat << "EOF"
src/main/java/com/artists/
â”œâ”€â”€ api/                  â†’ REST Controllers & DTOs
â”œâ”€â”€ application/          â†’ Business Logic Services
â”œâ”€â”€ domain/              â†’ JPA Entities
â”œâ”€â”€ infrastructure/      â†’ Repositories & Config
â””â”€â”€ presentation/        â†’ WebSocket Handlers

Resources:
â”œâ”€â”€ application.yml      â†’ Configuration
â”œâ”€â”€ db/migration/        â†’ Flyway SQL Scripts
â””â”€â”€ endpoints â†’25+ REST endpoints (documented in Swagger)
EOF

echo ""
echo -e "${YELLOW}â•â•â• API ENDPOINTS â•â•â•${NC}"
echo ""
echo -e "${BLUE}Authentication${NC}"
echo "  POST /v1/auth/login              - Login & get JWT tokens"
echo "  POST /v1/auth/refresh            - Refresh access token"
echo ""
echo -e "${BLUE}Artists${NC}"
echo "  GET  /v1/artists                 - List (paginated)"
echo "  GET  /v1/artists/{id}            - Get by ID"
echo "  GET  /v1/artists/search          - Search with sorting"
echo "  POST /v1/artists                 - Create (authenticated)"
echo "  PUT  /v1/artists/{id}            - Update (authenticated)"
echo "  DELETE /v1/artists/{id}          - Delete (authenticated)"
echo ""
echo -e "${BLUE}Albums${NC}"
echo "  GET  /v1/albums                  - List (paginated)"
echo "  GET  /v1/albums/{id}             - Get by ID"
echo "  GET  /v1/albums/search           - Search by title"
echo "  GET  /v1/albums/artist/{id}      - List by artist"
echo "  POST /v1/albums                  - Create (authenticated)"
echo "  PUT  /v1/albums/{id}             - Update (authenticated)"
echo "  POST /v1/albums/{id}/images      - Upload images (authenticated)"
echo "  DELETE /v1/albums/{id}           - Delete (authenticated)"
echo ""
echo -e "${BLUE}Regionais${NC}"
echo "  GET  /v1/regionais               - List active"
echo "  GET  /v1/regionais/all           - List all"
echo "  POST /v1/regionais/sync          - Manual sync (authenticated)"
echo ""
echo -e "${BLUE}Health${NC}"
echo "  GET  /v1/health                  - Full health check"
echo "  GET  /v1/health/live             - Liveness probe"
echo "  GET  /v1/health/ready            - Readiness probe"

echo ""
echo -e "${YELLOW}â•â•â• TESTING ENDPOINTS â•â•â•${NC}"
echo ""
echo "  # Login"
echo "  curl -X POST http://localhost:8080/api/v1/auth/login \\"
echo "    -H 'Content-Type: application/json' \\"
echo "    -d '{\"username\":\"admin\",\"password\":\"admin\"}'"
echo ""
echo "  # List Artists"
echo "  curl http://localhost:8080/api/v1/artists?page=0&size=10"
echo ""
echo "  # Search Artists"
echo "  curl 'http://localhost:8080/api/v1/artists/search?name=Serj&sort=asc'"
echo ""
echo "  # Create Album (requires JWT)"
echo "  curl -X POST http://localhost:8080/api/v1/albums \\"
echo "    -H 'Authorization: Bearer \$TOKEN' \\"
echo "    -H 'Content-Type: application/json' \\"
echo "    -d '{\"title\":\"My Album\",\"releaseYear\":2024}'"

echo ""
echo -e "${YELLOW}â•â•â• DOCUMENTATION FILES â•â•â•${NC}"
echo "  ðŸ“– README.md              - Complete documentation"
echo "  âš¡ QUICK_START.md         - 5-minute setup"
echo "  ðŸ—ï¸  ARCHITECTURE.md        - System architecture"
echo "  ðŸ“ CONTRIBUTING.md        - Development guidelines"
echo "  ðŸš€ DEPLOYMENT.md          - Production deployment"
echo "  ðŸ“Š PROJECT_SUMMARY.md     - Project overview"

echo ""
echo -e "${YELLOW}â•â•â• USEFUL COMMANDS â•â•â•${NC}"
echo ""
echo -e "  ${CYAN}Docker${NC}"
echo "    docker-compose up -d              Start all services"
echo "    docker-compose down               Stop all services"
echo "    docker-compose logs -f api        View API logs"
echo ""
echo -e "  ${CYAN}Maven${NC}"
echo "    mvn clean package                 Build project"
echo "    mvn test                          Run tests"
echo "    mvn spring-boot:run               Run locally"
echo ""
echo -e "  ${CYAN}Make${NC}"
echo "    make help                         Show all targets"
echo "    make build                        Build project"
echo "    make test                         Run tests"
echo "    make docker-up                    Start Docker"
echo "    make logs                         View logs"
echo ""
echo -e "  ${CYAN}Database${NC}"
echo "    postgres://localhost:5432/artists_db"
echo "    User: postgres | Password: postgres"
echo ""
echo -e "  ${CYAN}MinIO${NC}"
echo "    http://localhost:9001             Console"
echo "    http://localhost:9000             API"

echo ""
echo -e "${YELLOW}â•â•â• TECHNOLOGIES STACK â•â•â•${NC}"
echo ""
echo -e "  ${CYAN}Core${NC}"
echo "    â€¢ Spring Boot 3.3.0"
echo "    â€¢ Spring Web, Data JPA, Security"
echo "    â€¢ Spring WebSocket"
echo "    â€¢ Spring Actuator (Health checks)"
echo ""
echo -e "  ${CYAN}Database${NC}"
echo "    â€¢ PostgreSQL 16 (HikariCP)"
echo "    â€¢ Flyway (Migrations)"
echo ""
echo -e "  ${CYAN}Security${NC}"
echo "    â€¢ JWT (JJWT)"
echo "    â€¢ CORS"
echo "    â€¢ Rate Limiting (Google Guava)"
echo ""
echo -e "  ${CYAN}Integration${NC}"
echo "    â€¢ MinIO (S3-compatible)"
echo "    â€¢ WebSocket"
echo "    â€¢ External APIs (Regionais)"
echo ""
echo -e "  ${CYAN}Documentation${NC}"
echo "    â€¢ Springdoc OpenAPI"
echo "    â€¢ Swagger UI"
echo ""
echo -e "  ${CYAN}Testing${NC}"
echo "    â€¢ JUnit 5"
echo "    â€¢ Mockito"
echo ""
echo -e "  ${CYAN}DevOps${NC}"
echo "    â€¢ Docker"
echo "    â€¢ Docker Compose"
echo "    â€¢ Kubernetes-ready"

echo ""
echo -e "${YELLOW}â•â•â• FILE STRUCTURE â•â•â•${NC}"
echo ""
echo "  artists-api/"
echo "  â”œâ”€â”€ src/main/java/com/artists/"
echo "  â”‚   â”œâ”€â”€ api/                (Controllers, DTOs)"
echo "  â”‚   â”œâ”€â”€ application/        (Services)"
echo "  â”‚   â”œâ”€â”€ domain/             (Entities)"
echo "  â”‚   â”œâ”€â”€ infrastructure/     (Repositories, Config)"
echo "  â”‚   â””â”€â”€ presentation/       (WebSocket)"
echo "  â”œâ”€â”€ src/main/resources/"
echo "  â”‚   â”œâ”€â”€ application.yml"
echo "  â”‚   â””â”€â”€ db/migration/       (SQL Scripts)"
echo "  â”œâ”€â”€ src/test/java/          (Unit Tests)"
echo "  â”œâ”€â”€ pom.xml                 (Maven Config)"
echo "  â”œâ”€â”€ Dockerfile              (Container Image)"
echo "  â”œâ”€â”€ docker-compose.yml      (Orchestration)"
echo "  â”œâ”€â”€ Makefile                (Build Commands)"
echo "  â””â”€â”€ *.md                    (Documentation)"

echo ""
echo -e "${YELLOW}â•â•â• INITIAL DATA â•â•â•${NC}"
echo ""
echo "  Artists (4):"
echo "    â€¢ Serj Tankian"
echo "    â€¢ Mike Shinoda"
echo "    â€¢ Michel TelÃ³"
echo "    â€¢ Guns N' Roses"
echo ""
echo "  Albums (13):"
echo "    â€¢ Harakiri, Black Blooms, The Rough Dog"
echo "    â€¢ The Rising Tied, Post Traumatic, Post Traumatic EP, Where'd You Go"
echo "    â€¢ Bem Sertanejo, Bem Sertanejo - O Show (Ao Vivo), Bem Sertanejo - EP"
echo "    â€¢ Use Your Illusion I, Use Your Illusion II, Greatest Hits"

echo ""
echo -e "${YELLOW}â•â•â• NEXT STEPS â•â•â•${NC}"
echo ""
echo "  1ï¸âƒ£  Start Docker Compose:"
echo "     $ docker-compose up -d"
echo ""
echo "  2ï¸âƒ£  Wait for services to be ready (~30 seconds)"
echo ""
echo "  3ï¸âƒ£  Test the API:"
echo "     $ curl http://localhost:8080/api/v1/artists"
echo ""
echo "  4ï¸âƒ£  Access Swagger UI:"
echo "     â†’ http://localhost:8080/api/swagger-ui.html"
echo ""
echo "  5ï¸âƒ£  Read documentation:"
echo "     â†’ README.md (complete guide)"
echo "     â†’ QUICK_START.md (5-minute setup)"
echo "     â†’ ARCHITECTURE.md (system design)"

echo ""
echo -e "${GREEN}â•â•â• PROJECT READY FOR DEPLOYMENT â•â•â•${NC}"
echo ""
echo -e "${CYAN}All requirements implemented âœ“${NC}"
echo ""
echo "For support, check:"
echo "  â€¢ README.md"
echo "  â€¢ ARCHITECTURE.md"
echo "  â€¢ CONTRIBUTING.md"
echo "  â€¢ Swagger UI at http://localhost:8080/api/swagger-ui.html"
echo ""
echo -e "${CYAN}Built with â¤ï¸  using Spring Boot, Docker, PostgreSQL and MinIO${NC}"
echo ""
